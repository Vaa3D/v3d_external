<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>V3D: mg_image_lib.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">V3D</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('mg__image__lib_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<h1>mg_image_lib.h</h1>  </div>
</div>
<div class="contents">
<a href="mg__image__lib_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c)2006-2010  Hanchuan Peng (Janelia Farm, Howard Hughes Medical Institute).  </span>
<a name="l00003"></a>00003 <span class="comment"> * All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment"> */</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="comment">/************</span>
<a name="l00008"></a>00008 <span class="comment">                                            ********* LICENSE NOTICE ************</span>
<a name="l00009"></a>00009 <span class="comment"></span>
<a name="l00010"></a>00010 <span class="comment">This folder contains all source codes for the V3D project, which is subject to the following conditions if you want to use it. </span>
<a name="l00011"></a>00011 <span class="comment"></span>
<a name="l00012"></a>00012 <span class="comment">You will ***have to agree*** the following terms, *before* downloading/using/running/editing/changing any portion of codes in this package.</span>
<a name="l00013"></a>00013 <span class="comment"></span>
<a name="l00014"></a>00014 <span class="comment">1. This package is free for non-profit research, but needs a special license for any commercial purpose. Please contact Hanchuan Peng for details.</span>
<a name="l00015"></a>00015 <span class="comment"></span>
<a name="l00016"></a>00016 <span class="comment">2. You agree to appropriately cite this work in your related studies and publications.</span>
<a name="l00017"></a>00017 <span class="comment"></span>
<a name="l00018"></a>00018 <span class="comment">Peng, H., Ruan, Z., Long, F., Simpson, J.H., and Myers, E.W. (2010) “V3D enables real-time 3D visualization and quantitative analysis of large-scale biological image data sets,” Nature Biotechnology, Vol. 28, No. 4, pp. 348-353, DOI: 10.1038/nbt.1612. ( http://penglab.janelia.org/papersall/docpdf/2010_NBT_V3D.pdf )</span>
<a name="l00019"></a>00019 <span class="comment"></span>
<a name="l00020"></a>00020 <span class="comment">Peng, H, Ruan, Z., Atasoy, D., and Sternson, S. (2010) “Automatic reconstruction of 3D neuron structures using a graph-augmented deformable model,” Bioinformatics, Vol. 26, pp. i38-i46, 2010. ( http://penglab.janelia.org/papersall/docpdf/2010_Bioinfo_GD_ISMB2010.pdf )</span>
<a name="l00021"></a>00021 <span class="comment"></span>
<a name="l00022"></a>00022 <span class="comment">3. This software is provided by the copyright holders (Hanchuan Peng), Howard Hughes Medical Institute, Janelia Farm Research Campus, and contributors &quot;as is&quot; and any express or implied warranties, including, but not limited to, any implied warranties of merchantability, non-infringement, or fitness for a particular purpose are disclaimed. In no event shall the copyright owner, Howard Hughes Medical Institute, Janelia Farm Research Campus, or contributors be liable for any direct, indirect, incidental, special, exemplary, or consequential damages (including, but not limited to, procurement of substitute goods or services; loss of use, data, or profits; reasonable royalties; or business interruption) however caused and on any theory of liability, whether in contract, strict liability, or tort (including negligence or otherwise) arising in any way out of the use of this software, even if advised of the possibility of such damage.</span>
<a name="l00023"></a>00023 <span class="comment"></span>
<a name="l00024"></a>00024 <span class="comment">4. Neither the name of the Howard Hughes Medical Institute, Janelia Farm Research Campus, nor Hanchuan Peng, may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00025"></a>00025 <span class="comment"></span>
<a name="l00026"></a>00026 <span class="comment">*************/</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="comment">/*****************************************************************************************\</span>
<a name="l00032"></a>00032 <span class="comment">*                                                                                         *</span>
<a name="l00033"></a>00033 <span class="comment">*  Image and Image Stack Data Abstraction for TIF-encoded files                           *</span>
<a name="l00034"></a>00034 <span class="comment">*                                                                                         *</span>
<a name="l00035"></a>00035 <span class="comment">*  Author:  Gene Myers                                                                    *</span>
<a name="l00036"></a>00036 <span class="comment">*  Date  :  August 2006                                                                   *</span>
<a name="l00037"></a>00037 <span class="comment">*                                                                                         *</span>
<a name="l00038"></a>00038 <span class="comment">\*****************************************************************************************/</span>
<a name="l00039"></a>00039 <span class="comment">/* changed the include file name by PHC 060816*/</span>
<a name="l00040"></a>00040 <span class="comment">/* comment uint8 and uint16 types on 070808 */</span>
<a name="l00041"></a>00041 <span class="comment">//2010-05-20: add the path of tiffio.h, PHC</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="preprocessor">#ifndef MG_IMAGE_LIB</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span>
<a name="l00045"></a>00045 <span class="preprocessor">#define MG_IMAGE_LIB</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;tiffio.h&quot;</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049    <span class="comment">//  There are three kinds of images or stacks:</span>
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="mg__image__lib_8h.html#adce122f566c88a1eceeb79a635afa964">00051</a> <span class="preprocessor">#define GREY   1   // 1-byte grey-level image or stack</span>
<a name="l00052"></a><a class="code" href="mg__image__lib_8h.html#ad0b723eba34f470b040fb57309f1bc14">00052</a> <span class="preprocessor"></span><span class="preprocessor">#define GREY16 2   // 2-byte grey-level image or stack</span>
<a name="l00053"></a><a class="code" href="mg__image__lib_8h.html#a4b5014034c9aac136ab8c82c2d16dc82">00053</a> <span class="preprocessor"></span><span class="preprocessor">#define COLOR  3   // 3-byte RGB image or stack</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span>
<a name="l00055"></a><a class="code" href="mg__image__lib_8h.html#a1fd36be3e58104dc587ca5c4a4fe3560">00055</a> <span class="preprocessor">#define GREY_CHANNEL  0   // Images and stacks either have a single grey channel or 3 color channels</span>
<a name="l00056"></a><a class="code" href="mg__image__lib_8h.html#aa046b5ef53d48e3e4f45d9e874b0a5af">00056</a> <span class="preprocessor"></span><span class="preprocessor">#define RED_CHANNEL   0</span>
<a name="l00057"></a><a class="code" href="mg__image__lib_8h.html#a5d7dfb4c6f363f64fb5244306be56384">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define GREEN_CHANNEL 1</span>
<a name="l00058"></a><a class="code" href="mg__image__lib_8h.html#a5fa37f328031f01a4de43f9aaf8bf758">00058</a> <span class="preprocessor"></span><span class="preprocessor">#define BLUE_CHANNEL  2</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>
<a name="l00060"></a>00060 <span class="comment">/*These two variables have been defined in tiffio.h. Thus comment. */</span>
<a name="l00061"></a>00061 <span class="comment">/*</span>
<a name="l00062"></a>00062 <span class="comment">typedef unsigned char  uint8;   //  Datatypes for 1 byte and 2 byte pixel values</span>
<a name="l00063"></a>00063 <span class="comment">typedef unsigned short uint16;</span>
<a name="l00064"></a>00064 <span class="comment">*/</span>
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="comment">/* IMAGE ABSTRACTION  */</span>
<a name="l00068"></a>00068 
<a name="l00069"></a><a class="code" href="structImage.html">00069</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00070"></a><a class="code" href="structImage.html#ab961f0bab26537f6671c9c1add6e6725">00070</a>   { <span class="keywordtype">int</span>      <a class="code" href="structImage.html#ab961f0bab26537f6671c9c1add6e6725">kind</a>;
<a name="l00071"></a><a class="code" href="structImage.html#a2474a5474cbff19523a51eb1de01cda4">00071</a>     <span class="keywordtype">int</span>      <a class="code" href="structImage.html#a2474a5474cbff19523a51eb1de01cda4">width</a>; 
<a name="l00072"></a><a class="code" href="structImage.html#ad12fc34ce789bce6c8a05d8a17138534">00072</a>     <span class="keywordtype">int</span>      <a class="code" href="structImage.html#ad12fc34ce789bce6c8a05d8a17138534">height</a>;
<a name="l00073"></a><a class="code" href="structImage.html#a8bc1a01282b9e73f8119aa340598d86c">00073</a>     uint8   *<a class="code" href="structImage.html#a8bc1a01282b9e73f8119aa340598d86c">array</a>;   <span class="comment">// Array of pixel values lexicographically ordered on (y,x,c).</span>
<a name="l00074"></a>00074   } <a class="code" href="structImage.html">Image</a>;            <span class="comment">//    Pixel (0,0) is the lower left-hand corner of an image.</span>
<a name="l00075"></a>00075 
<a name="l00076"></a>00076   <span class="comment">/*  The macros and routines below serve to illustrate how pixel information is organized</span>
<a name="l00077"></a>00077 <span class="comment">        in the 1-dimensional image &quot;array&quot;.  Generally, for any extensive image manipulation</span>
<a name="l00078"></a>00078 <span class="comment">        one optimizes the computation of locations into the array.                           */</span>
<a name="l00079"></a>00079 
<a name="l00080"></a><a class="code" href="mg__image__lib_8h.html#a9e9408c12cb9317e48e11550e375629e">00080</a> <span class="preprocessor">#define IMAGE_PIXEL_8(img,x,y,c) \</span>
<a name="l00081"></a>00081 <span class="preprocessor">      ((uint8  *) ((img)-&gt;array + (((y)*(img)-&gt;width + (x))*(img)-&gt;kind + (c))))</span>
<a name="l00082"></a>00082 <span class="preprocessor"></span>
<a name="l00083"></a><a class="code" href="mg__image__lib_8h.html#afed1fa2c9b513265eaa286c6c4b21a28">00083</a> <span class="preprocessor">#define IMAGE_PIXEL_16(img,x,y,c) \</span>
<a name="l00084"></a>00084 <span class="preprocessor">      ((uint16 *) ((img)-&gt;array + (((y)*(img)-&gt;width + (x))*(img)-&gt;kind + (c))))</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span>
<a name="l00086"></a>00086 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> Get_Image_Pixel(<a class="code" href="structImage.html">Image</a> *image, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> c)
<a name="l00087"></a>00087 { <span class="keywordflow">if</span> (image-&gt;<a class="code" href="structImage.html#ab961f0bab26537f6671c9c1add6e6725">kind</a> == <a class="code" href="mg__image__lib_8h.html#ad0b723eba34f470b040fb57309f1bc14">GREY16</a>)
<a name="l00088"></a>00088     <span class="keywordflow">return</span> (*<a class="code" href="mg__image__lib_8h.html#afed1fa2c9b513265eaa286c6c4b21a28">IMAGE_PIXEL_16</a>(image,x,y,c));
<a name="l00089"></a>00089   <span class="keywordflow">else</span>
<a name="l00090"></a>00090     <span class="keywordflow">return</span> (*<a class="code" href="mg__image__lib_8h.html#a9e9408c12cb9317e48e11550e375629e">IMAGE_PIXEL_8</a>(image,x,y,c));
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> Set_Image_Pixel(<a class="code" href="structImage.html">Image</a> *image, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> c, <span class="keywordtype">int</span> v)
<a name="l00094"></a>00094 { <span class="keywordflow">if</span> (image-&gt;<a class="code" href="structImage.html#ab961f0bab26537f6671c9c1add6e6725">kind</a> == <a class="code" href="mg__image__lib_8h.html#ad0b723eba34f470b040fb57309f1bc14">GREY16</a>)
<a name="l00095"></a>00095     *<a class="code" href="mg__image__lib_8h.html#afed1fa2c9b513265eaa286c6c4b21a28">IMAGE_PIXEL_16</a>(image,x,y,c) = v;
<a name="l00096"></a>00096   <span class="keywordflow">else</span>
<a name="l00097"></a>00097     *<a class="code" href="mg__image__lib_8h.html#a9e9408c12cb9317e48e11550e375629e">IMAGE_PIXEL_8</a>(image,x,y,c) = v;
<a name="l00098"></a>00098 }
<a name="l00099"></a>00099 
<a name="l00100"></a>00100   <span class="comment">/*  Basic I/O primitives:</span>
<a name="l00101"></a>00101 <span class="comment">        Open_Tiff opens the named .tif file in the specified mode (typically &quot;r&quot; or &quot;w&quot;).  A series</span>
<a name="l00102"></a>00102 <span class="comment">      of images can be written to &#39;tif&#39; with Write_Tiff to create a stack or a single image can</span>
<a name="l00103"></a>00103 <span class="comment">      be written to create an image tif file.  One can similarly read a series of tif images from</span>
<a name="l00104"></a>00104 <span class="comment">      an open tif file, when the last one is read, the flag at the location pointed to by &#39;last&#39;</span>
<a name="l00105"></a>00105 <span class="comment">      is set to non-zero.  Closing the tif with Close_Tiff completes the creation or scan of &#39;tif&#39;.</span>
<a name="l00106"></a>00106 <span class="comment">  */</span>
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 TIFF   *<a class="code" href="mg__image__lib_8cpp.html#ad029ae7747dd64ec921f3f76f6270956">Open_Tiff</a>(<span class="keywordtype">char</span> *file_name, <span class="keywordtype">char</span> *mode);
<a name="l00109"></a>00109 <a class="code" href="structImage.html">Image</a>  *<a class="code" href="mg__image__lib_8cpp.html#aef5a55f45157b19ea3a33575c834e0d1">Read_Tiff</a>(TIFF *tif, <span class="keywordtype">int</span> *last);
<a name="l00110"></a>00110 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#a2f90fead964762878fd199e2ca52329d">Write_Tiff</a>(TIFF *tif, <a class="code" href="structImage.html">Image</a> *a_image);
<a name="l00111"></a>00111 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#a1dfc1b0722abb1773dcec1f1e1f9fb1f">Close_Tiff</a>(TIFF *tif);
<a name="l00112"></a>00112 
<a name="l00113"></a>00113   <span class="comment">/*  Image Library:</span>
<a name="l00114"></a>00114 <span class="comment">         One can read, write, copy, pack, free, and kill images.  Also one can create a new</span>
<a name="l00115"></a>00115 <span class="comment">      uninitialized image with &quot;New_Image&quot;.  The largest and smallest pixel value in a channel</span>
<a name="l00116"></a>00116 <span class="comment">      of an image is returned by &quot;Image_Range&quot; and using these one can then transform the values</span>
<a name="l00117"></a>00117 <span class="comment">      in an image with &quot;Scale_Image&quot; where &lt;new_value&gt; = &lt;old_value&gt;*factor + offset.  These</span>
<a name="l00118"></a>00118 <span class="comment">      returns are mostly of value for GREY16 images where is is often the case that the maximum</span>
<a name="l00119"></a>00119 <span class="comment">      value is much less than 0xFFFF (e.g. 12-bit images).</span>
<a name="l00120"></a>00120 <span class="comment">        One can convert an image to any other type (specified by the parameter &quot;kind&quot;) of image</span>
<a name="l00121"></a>00121 <span class="comment">      with &quot;Translate_Image&quot;.  No scaling of values takes place except when a GREY16 stack</span>
<a name="l00122"></a>00122 <span class="comment">      containing values greater than 255 is converted to a GREY or COLOR image.  In these cases</span>
<a name="l00123"></a>00123 <span class="comment">      values are scaled so the maximum GREY16 value in the image becomes 255 in the converted</span>
<a name="l00124"></a>00124 <span class="comment">      GREY or COLOR image.  If &quot;in_place&quot; is zero then a new image of the desired type is</span>
<a name="l00125"></a>00125 <span class="comment">      generated, otherwise the input image is modified to be of the desired type, where its</span>
<a name="l00126"></a>00126 <span class="comment">      array is enlarged with a realloc if necessary to accomodate the result.  If the translated</span>
<a name="l00127"></a>00127 <span class="comment">      result is smaller than the original, the array is not made smaller (in case you want the</span>
<a name="l00128"></a>00128 <span class="comment">      bigger container to be recirculated).  If you want the translated result to be shrunk</span>
<a name="l00129"></a>00129 <span class="comment">      then call Pack_Image on it.</span>
<a name="l00130"></a>00130 <span class="comment">  */</span>
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 <a class="code" href="structImage.html">Image</a> *<a class="code" href="mg__image__lib_8cpp.html#af60761715299b2652acb2bcc6bdc03b0">Read_Image</a>(<span class="keywordtype">char</span> *file_name);
<a name="l00133"></a>00133 <a class="code" href="structImage.html">Image</a> *<a class="code" href="mg__image__lib_8cpp.html#a74658cd3697cfda7b475f51a46adb7ca">Make_Image</a>(<span class="keywordtype">int</span> kind, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height);
<a name="l00134"></a>00134 <a class="code" href="structImage.html">Image</a> *<a class="code" href="mg__image__lib_8cpp.html#a0e0249ab8e454775a1a64afa88e36652">Translate_Image</a>(<a class="code" href="structImage.html">Image</a> *image, <span class="keywordtype">int</span> kind, <span class="keywordtype">int</span> in_place);
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#af493ede9f3d5c762a8bb71f270abd7ec">Write_Image</a>(<span class="keywordtype">char</span> *file_name, <a class="code" href="structImage.html">Image</a> *a_image);
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="structPixel__Range.html">00138</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00139"></a><a class="code" href="structPixel__Range.html#ab78d5bc0b5eb537373d2ae9db01011b4">00139</a>   { <span class="keywordtype">int</span> <a class="code" href="structPixel__Range.html#ab78d5bc0b5eb537373d2ae9db01011b4">maxval</a>;
<a name="l00140"></a><a class="code" href="structPixel__Range.html#a271861b7d4422e3cddf03d604408cf3a">00140</a>     <span class="keywordtype">int</span> <a class="code" href="structPixel__Range.html#a271861b7d4422e3cddf03d604408cf3a">minval</a>;
<a name="l00141"></a>00141   } <a class="code" href="structPixel__Range.html">Pixel_Range</a>;
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 <a class="code" href="structPixel__Range.html">Pixel_Range</a> *<a class="code" href="mg__image__lib_8cpp.html#a99903c77f76288fc06346eab08dad317">Image_Range</a>(<a class="code" href="structImage.html">Image</a> *image, <span class="keywordtype">int</span> channel);
<a name="l00144"></a>00144 <span class="keywordtype">void</span>         <a class="code" href="mg__image__lib_8cpp.html#af5e0b09ecd5556a5d49c9cbb85e3c8a4">Scale_Image</a>(<a class="code" href="structImage.html">Image</a> *image, <span class="keywordtype">int</span> channel, <span class="keywordtype">double</span> factor, <span class="keywordtype">double</span> offset);
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 <a class="code" href="structImage.html">Image</a> *<a class="code" href="mg__image__lib_8cpp.html#a930b297ea66cbc08d02919dd82d56612">Copy_Image</a>(<a class="code" href="structImage.html">Image</a> *image);
<a name="l00147"></a>00147 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#a87b4c6ab888993bcffb578bdbec71bb4">Pack_Image</a>(<a class="code" href="structImage.html">Image</a> *image);
<a name="l00148"></a>00148 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#a7f6e96dd8f6649161ee34e841e24891a">Free_Image</a>(<a class="code" href="structImage.html">Image</a> *image);
<a name="l00149"></a>00149 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#a0cb8ace6cf0e8ddd8028b7ce7a5a49a4">Kill_Image</a>(<a class="code" href="structImage.html">Image</a> *image);
<a name="l00150"></a>00150 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#a3ac15f63e0b69c810465a7b8c3f0db01">Reset_Image</a>();
<a name="l00151"></a>00151 <span class="keywordtype">int</span>    <a class="code" href="mg__image__lib_8cpp.html#a3dd8ccb8bbc838f6a034247b16e81d6f">Image_Usage</a>();
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 <span class="comment">/* STACK ABSTRACTION */</span>
<a name="l00155"></a>00155 
<a name="l00156"></a><a class="code" href="structStack.html">00156</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00157"></a><a class="code" href="structStack.html#ab961f0bab26537f6671c9c1add6e6725">00157</a>   { <span class="keywordtype">int</span>      <a class="code" href="structStack.html#ab961f0bab26537f6671c9c1add6e6725">kind</a>;
<a name="l00158"></a><a class="code" href="structStack.html#a2474a5474cbff19523a51eb1de01cda4">00158</a>     <span class="keywordtype">int</span>      <a class="code" href="structStack.html#a2474a5474cbff19523a51eb1de01cda4">width</a>;
<a name="l00159"></a><a class="code" href="structStack.html#ad12fc34ce789bce6c8a05d8a17138534">00159</a>     <span class="keywordtype">int</span>      <a class="code" href="structStack.html#ad12fc34ce789bce6c8a05d8a17138534">height</a>;
<a name="l00160"></a><a class="code" href="structStack.html#acb5ba97551079e0b072c62c21d784ac5">00160</a>     <span class="keywordtype">int</span>      <a class="code" href="structStack.html#acb5ba97551079e0b072c62c21d784ac5">depth</a>;
<a name="l00161"></a><a class="code" href="structStack.html#a8bc1a01282b9e73f8119aa340598d86c">00161</a>     uint8   *<a class="code" href="structStack.html#a8bc1a01282b9e73f8119aa340598d86c">array</a>;   <span class="comment">// array of pixel values lexicographically ordered on (z,y,x,c)</span>
<a name="l00162"></a>00162   } <a class="code" href="structStack.html">Stack</a>;
<a name="l00163"></a>00163 
<a name="l00164"></a>00164   <span class="comment">/*  The macros and routines below serve to illustrate how pixel information is organized</span>
<a name="l00165"></a>00165 <span class="comment">        in the 1-dimensional stack &quot;array&quot;.  Generally, for any extensive stack manipulation</span>
<a name="l00166"></a>00166 <span class="comment">        one optimizes the computation of locations into the array.                           */</span>
<a name="l00167"></a>00167 
<a name="l00168"></a><a class="code" href="mg__image__lib_8h.html#acff974ad637dc433866346f4cd2de4a0">00168</a> <span class="preprocessor">#define STACK_PIXEL_8(img,x,y,z,c) \</span>
<a name="l00169"></a>00169 <span class="preprocessor">      ((uint8  *) ((img)-&gt;array +   \</span>
<a name="l00170"></a>00170 <span class="preprocessor">           ((((z)*(img)-&gt;height + (y))*(img)-&gt;width + (x))*(img)-&gt;kind + (c))))</span>
<a name="l00171"></a>00171 <span class="preprocessor"></span>
<a name="l00172"></a><a class="code" href="mg__image__lib_8h.html#acebac630484551ca858f3e17919a6e90">00172</a> <span class="preprocessor">#define STACK_PIXEL_16(img,x,y,z,c) \</span>
<a name="l00173"></a>00173 <span class="preprocessor">      ((uint16 *) ((img)-&gt;array +   \</span>
<a name="l00174"></a>00174 <span class="preprocessor">           ((((z)*(img)-&gt;height + (y))*(img)-&gt;width + (x))*(img)-&gt;kind + (c))))</span>
<a name="l00175"></a>00175 <span class="preprocessor"></span>
<a name="l00176"></a>00176 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> Get_Stack_Pixel(<a class="code" href="structStack.html">Stack</a> *stack, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> z, <span class="keywordtype">int</span> c)
<a name="l00177"></a>00177 { <span class="keywordflow">if</span> (stack-&gt;<a class="code" href="structStack.html#ab961f0bab26537f6671c9c1add6e6725">kind</a> == <a class="code" href="mg__image__lib_8h.html#ad0b723eba34f470b040fb57309f1bc14">GREY16</a>)
<a name="l00178"></a>00178     <span class="keywordflow">return</span> (*<a class="code" href="mg__image__lib_8h.html#acebac630484551ca858f3e17919a6e90">STACK_PIXEL_16</a>(stack,x,y,z,c));
<a name="l00179"></a>00179   <span class="keywordflow">else</span>
<a name="l00180"></a>00180     <span class="keywordflow">return</span> (*<a class="code" href="mg__image__lib_8h.html#acff974ad637dc433866346f4cd2de4a0">STACK_PIXEL_8</a>(stack,x,y,z,c));
<a name="l00181"></a>00181 }
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> Set_Stack_Pixel(<a class="code" href="structStack.html">Stack</a> *stack, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> z, <span class="keywordtype">int</span> c, <span class="keywordtype">int</span> v)
<a name="l00184"></a>00184 { <span class="keywordflow">if</span> (stack-&gt;<a class="code" href="structStack.html#ab961f0bab26537f6671c9c1add6e6725">kind</a> == <a class="code" href="mg__image__lib_8h.html#ad0b723eba34f470b040fb57309f1bc14">GREY16</a>)
<a name="l00185"></a>00185     *<a class="code" href="mg__image__lib_8h.html#acebac630484551ca858f3e17919a6e90">STACK_PIXEL_16</a>(stack,x,y,z,c) = v;
<a name="l00186"></a>00186   <span class="keywordflow">else</span>
<a name="l00187"></a>00187     *<a class="code" href="mg__image__lib_8h.html#acff974ad637dc433866346f4cd2de4a0">STACK_PIXEL_8</a>(stack,x,y,z,c) = v;
<a name="l00188"></a>00188 }
<a name="l00189"></a>00189 
<a name="l00190"></a>00190   <span class="comment">/*   Stack Library:</span>
<a name="l00191"></a>00191 <span class="comment">         One has exactly the same primitives as for images, with the addition of a primitive</span>
<a name="l00192"></a>00192 <span class="comment">       &quot;Select_Plane&quot; that selects a given plane out of a stack and returns a pointer to an</span>
<a name="l00193"></a>00193 <span class="comment">       image record containing it.  The plane is not allocated anew but is simply pointed at</span>
<a name="l00194"></a>00194 <span class="comment">       within the stack by the &quot;Stack_Plane&quot; record statically owned by &quot;Select_Plane&quot;.</span>
<a name="l00195"></a>00195 <span class="comment">  */</span>
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 <a class="code" href="structStack.html">Stack</a> *<a class="code" href="mg__image__lib_8cpp.html#a987cce9a4c318d1cdf23999075642adb">Read_Stack</a>(<span class="keywordtype">char</span> *file_name);
<a name="l00198"></a>00198 <a class="code" href="structStack.html">Stack</a> *<a class="code" href="mg__image__lib_8cpp.html#aa1658e52b31dc006f3176cd3a3b2dcea">Make_Stack</a>(<span class="keywordtype">int</span> kind, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height, <span class="keywordtype">int</span> depth);
<a name="l00199"></a>00199 <a class="code" href="structStack.html">Stack</a> *<a class="code" href="mg__image__lib_8cpp.html#a124515402d0e14550d9f714c1a23d1b0">Translate_Stack</a>(<a class="code" href="structStack.html">Stack</a> *stack, <span class="keywordtype">int</span> kind, <span class="keywordtype">int</span> in_place);
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 <a class="code" href="structStack.html">Stack</a> *<a class="code" href="mg__image__lib_8cpp.html#a919968c5d3e3ac4e053b07cfd7c23480">Read_LSM_Stack</a>(<span class="keywordtype">char</span> *file_name);<span class="comment">/*070713*/</span>
<a name="l00202"></a>00202 
<a name="l00203"></a>00203 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#adc9e26b6a71e92a8dd8ef83ee6b0c260">Write_Stack</a>(<span class="keywordtype">char</span> *file_name, <a class="code" href="structStack.html">Stack</a> *a_stack);
<a name="l00204"></a>00204 
<a name="l00205"></a>00205 <a class="code" href="structPixel__Range.html">Pixel_Range</a> *<a class="code" href="mg__image__lib_8cpp.html#a119f9239ec25e397b8cc176afb24fb8f">Stack_Range</a>(<a class="code" href="structStack.html">Stack</a> *stack, <span class="keywordtype">int</span> channel);
<a name="l00206"></a>00206 <span class="keywordtype">void</span>         <a class="code" href="mg__image__lib_8cpp.html#a40f9097ca82e17ba8dae8b2bd2296887">Scale_Stack</a>(<a class="code" href="structStack.html">Stack</a> *stack, <span class="keywordtype">int</span> channel, <span class="keywordtype">double</span> factor, <span class="keywordtype">double</span> offset);
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 <a class="code" href="structStack.html">Stack</a> *<a class="code" href="mg__image__lib_8cpp.html#ab7d626ff94c09bdab53db4dace026df9">Copy_Stack</a>(<a class="code" href="structStack.html">Stack</a> *stack);
<a name="l00209"></a>00209 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#ae5771fb389c8f155b512f518e1762f5b">Pack_Stack</a>(<a class="code" href="structStack.html">Stack</a> *stack);
<a name="l00210"></a>00210 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#a7836dbf8238f020a6274af65fbf3f071">Free_Stack</a>(<a class="code" href="structStack.html">Stack</a> *stack);
<a name="l00211"></a>00211 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#a81402a044c52c35eeceac1a73d07e91b">Kill_Stack</a>(<a class="code" href="structStack.html">Stack</a> *stack);
<a name="l00212"></a>00212 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#aaece5d89a0dca735b1259df9c99988c3">Reset_Stack</a>();
<a name="l00213"></a>00213 <span class="keywordtype">int</span>    <a class="code" href="mg__image__lib_8cpp.html#ab7c21f7be34ff4ba42b2c9461feb8d80">Stack_Usage</a>();
<a name="l00214"></a>00214 
<a name="l00215"></a><a class="code" href="mg__image__lib_8h.html#a159b6c4b98521fac05589498e4d52177">00215</a> <span class="keyword">typedef</span> <a class="code" href="structImage.html">Image</a> <a class="code" href="mg__image__lib_8h.html#a159b6c4b98521fac05589498e4d52177">Stack_Plane</a>;
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 Stack_Plane *<a class="code" href="mg__image__lib_8cpp.html#a5e6e8dc1c0a86b2de1e5201ad548e856">Select_Plane</a>(<a class="code" href="structStack.html">Stack</a> *a_stack, <span class="keywordtype">int</span> plane);
<a name="l00218"></a>00218 
<a name="l00219"></a>00219   <span class="comment">/*   File Stack Routines;</span>
<a name="l00220"></a>00220 <span class="comment"></span>
<a name="l00221"></a>00221 <span class="comment">         Parse_Stack_Name parses a file name assuming it is of the form &quot;&lt;prefix&gt;&lt;first_num&gt;.tif&quot;</span>
<a name="l00222"></a>00222 <span class="comment">     and returns the constituent parts where &#39;num_width&#39; is the number of characters used to</span>
<a name="l00223"></a>00223 <span class="comment">     represent &#39;first_num&#39;.  A file-based stack is encoded as a sequence of files with names of</span>
<a name="l00224"></a>00224 <span class="comment">     this form where the planes of the stack are in successively numbered files, e.g.</span>
<a name="l00225"></a>00225 <span class="comment">     x.001.tif x.002.tif ... x.037.tif.  The number part is assumed to always involve the</span>
<a name="l00226"></a>00226 <span class="comment">     same number of digits and be zero-padded as necessary.  The numbers are assumed to form</span>
<a name="l00227"></a>00227 <span class="comment">     a contiguous range (that does *not* need to start at 0 or 1).</span>
<a name="l00228"></a>00228 <span class="comment">  </span>
<a name="l00229"></a>00229 <span class="comment">     Given the parse information, one can then read or write a file-type stack.</span>
<a name="l00230"></a>00230 <span class="comment">  */</span>
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#a448610de5fed33f90c6020e316a7c9eb">Parse_Stack_Name</a>(<span class="keywordtype">char</span> *file_name, <span class="keywordtype">char</span> **prefix, <span class="keywordtype">int</span> *num_width, <span class="keywordtype">int</span> *first_num);
<a name="l00233"></a>00233 <a class="code" href="structStack.html">Stack</a> *<a class="code" href="mg__image__lib_8cpp.html#a17e66fafc15fcb6aff68b170100bc011">Read_Stack_Planes</a>(<span class="keywordtype">char</span> *prefix, <span class="keywordtype">int</span> num_width, <span class="keywordtype">int</span> first_num);
<a name="l00234"></a>00234 <span class="keywordtype">void</span>   <a class="code" href="mg__image__lib_8cpp.html#a0d4ec52f19e1513369ee06e0b4f07561">Write_Stack_Planes</a>(<span class="keywordtype">char</span> *prefix, <span class="keywordtype">int</span> num_width, <span class="keywordtype">int</span> first_num, <a class="code" href="structStack.html">Stack</a> *a_stack);
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="mg__image__lib_8h.html">mg_image_lib.h</a>      </li>
      <li class="footer">Generated on Tue Feb 22 2011 10:19:45 for V3D by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
